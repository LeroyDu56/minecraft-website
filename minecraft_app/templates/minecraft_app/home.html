{% extends 'minecraft_app/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="video-background">
        <video id="background-video" autoplay loop muted playsinline>
            <source src="{% static 'videos/background_loop.mp4' %}" type="video/mp4">
        </video>
        <div class="video-overlay"></div>
    </div>
    
    <div class="hero-content">
        <div class="hero-title-image">
            <img src="{% static 'images/TEXT_NOVANIA.png' %}" alt="Novania" class="text-logo">
        </div>
        <p class="hero-subtitle">Towny Minecraft Server on an Earth Map</p>
        <p class="hero-description">Create your town, join a nation, and shape the history of the world your way.</p>
        <div class="hero-buttons">
            <a href="#join" class="btn btn-accent glow-effect">Play Now</a>
            <a href="{% url 'dynmap' %}" class="btn glass-effect">View Map</a>
        </div>
    </div>
</section>

<!-- Server Join Section -->
<section id="join" class="join-section">
    <div class="container">
        <h2 class="section-title">Join the Adventure</h2>
        <p class="section-subtitle">Embark on an epic journey through our Earth-scale world</p>
        
        <div class="server-info-card">
            <div class="server-info-header">
                <div class="server-name">Novania - Earth Towny</div>
                <div class="server-status">
                    <span class="status-indicator {% if server.status %}status-online{% else %}status-offline{% endif %}"></span>
                    <span>{% if server.status %}Online{% else %}Offline{% endif %}</span>
                    <span class="player-count">{{ server.player_count }}/{{ server.max_players }}</span>
                </div>
            </div>
            
            <div class="server-content">
                <p class="server-description">Join a community of builders, traders, and adventurers on our immersive 1:1000 scale Earth map. Claim your territory, build your town, and shape the history of our virtual world.</p>
                
                <div id="server-ip" class="server-ip">play.novania.fr</div>
                
                <div class="join-now">
                    
                    <p>Simply copy the server address and add it to your Minecraft server list</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Script pour copier l'IP au clic -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const serverIp = document.getElementById('server-ip');
        const copyBtn = document.getElementById('copy-ip');
        
        // Fonction pour copier l'IP au clic
        function copyIpToClipboard() {
            const ip = 'play.novania.fr';
            navigator.clipboard.writeText(ip).then(function() {
                // Effet visuel pour indiquer la copie
                copyBtn.textContent = 'IP Copied!';
                copyBtn.classList.add('copied');
                
                setTimeout(function() {
                    copyBtn.textContent = 'Copy IP Address';
                    copyBtn.classList.remove('copied');
                }, 2000);
            });
        }
        
        // Ajouter l'événement au clic sur le bouton et sur l'IP
        copyBtn.addEventListener('click', copyIpToClipboard);
        serverIp.addEventListener('click', copyIpToClipboard);
    });
</script>

<!-- Features Section -->
<section class="features-section">
    <div class="container">
        <h2 class="section-title">Discover Our Features</h2>
        <p class="section-subtitle">What makes Novania unique</p>
        
        <div class="grid-3">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-globe"></i></div>
                <h3 class="feature-title">Earth Map</h3>
                <p class="feature-description">Play on a realistic 1:1000 scale map of Earth. Settle in real-world locations and claim your homeland.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-landmark"></i></div>
                <h3 class="feature-title">Towny System</h3>
                <p class="feature-description">Create towns, form nations, and engage in diplomacy, trade or warfare with other players.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-users"></i></div>
                <h3 class="feature-title">Active Community</h3>
                <p class="feature-description">Join our friendly community of players working together to recreate history or forge a new path.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-balance-scale"></i></div>
                <h3 class="feature-title">Balanced Economy</h3>
                <p class="feature-description">Engage in player-driven economy with shops, jobs, and various ways to earn money.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                <h3 class="feature-title">Land Protection</h3>
                <p class="feature-description">Your claims are fully protected against griefing while still allowing for strategic gameplay.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-cogs"></i></div>
                <h3 class="feature-title">Custom Plugins</h3>
                <p class="feature-description">Experience unique gameplay features with our custom plugins designed to enhance the Towny experience.</p>
            </div>
        </div>
    </div>
</section>

<!-- Top Nations Section -->
<section class="nations-section">
    <div class="container">
        <h2 class="section-title">Featured Nations</h2>
        <p class="section-subtitle">The most powerful nations on our server</p>
        
        <div class="grid-4">
            {% for nation in nations %}
                <div class="nation-card">
                    <div class="nation-flag">
                        <img src="{{ nation.flag_image|default:'../images/default-flag.jpg' }}" alt="{{ nation.name }} Flag">
                    </div>
                    <h3 class="nation-name">{{ nation.name }}</h3>
                    <p class="nation-details">Capital: {{ nation.capital }}</p>
                    <p class="nation-details">Leader: {{ nation.leader }}</p>
                    <p class="nation-details">Towns: {{ nation.towns_count }}</p>
                    <a href="{% url 'nation_detail' nation.id %}" class="btn">View Nation</a>
                </div>
            {% empty %}
                <!-- Sample nations if no data available -->
                <div class="nation-card">
                    <div class="nation-flag">
                        <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                    </div>
                    <h3 class="nation-name">None</h3>
                    <p class="nation-details">Capital: None</p>
                    <p class="nation-details">Leader: None</p>
                    <p class="nation-details">Towns: None</p>
                    <a href="#" class="btn">View Nation</a>
                </div>
                
                <div class="nation-card">
                    <div class="nation-flag">
                        <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                    </div>
                    <h3 class="nation-name">None</h3>
                    <p class="nation-details">Capital: None</p>
                    <p class="nation-details">Leader: None</p>
                    <p class="nation-details">Towns: None</p>
                    <a href="#" class="btn">View Nation</a>
                </div>
                
                <div class="nation-card">
                    <div class="nation-flag">
                        <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                    </div>
                    <h3 class="nation-name">None</h3>
                    <p class="nation-details">Capital: None</p>
                    <p class="nation-details">Leader: None</p>
                    <p class="nation-details">Towns: None</p>
                    <a href="#" class="btn">View Nation</a>
                </div>
                
                <div class="nation-card">
                    <div class="nation-flag">
                        <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                    </div>
                    <h3 class="nation-name">None</h3>
                    <p class="nation-details">Capital: None</p>
                    <p class="nation-details">Leader: None</p>
                    <p class="nation-details">Towns: None</p>
                    <a href="#" class="btn">View Nation</a>
                </div>
            {% endfor %}
        </div>
    </div>
</section>



<!-- Call to Action -->
<section class="cta-section">
    <div class="container">
        <div class="cta-container">
            <h2 class="cta-title">Ready to Start Your Adventure?</h2>
            <p class="cta-text">Join our Discord community to connect with other players, get help, and stay updated on server events.</p>
            <div class="cta-buttons">
                <a href="https://discord.gg/a8G7wUKp2Y" class="btn discord-btn" target="_blank"><i class="fab fa-discord"></i> Join Our Discord</a>
                <a href="{% url 'rules' %}" class="btn">Read the Rules</a>
            </div>
        </div>
    </div>
</section>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const video = document.getElementById('background-video');
        
        // Créer l'effet de fondu à la fin de chaque lecture
        video.addEventListener('timeupdate', function() {
            // Si la vidéo est proche de la fin (2 secondes avant)
            if (video.currentTime >= video.duration - 2) {
                // Commencer le fondu
                video.style.opacity = 1 - ((video.duration - video.currentTime) / 2);
            } else if (video.currentTime <= 2) {
                // Fondu en entrée au début
                video.style.opacity = video.currentTime / 2;
            } else {
                // Opacité normale pendant la lecture
                video.style.opacity = 1;
            }
        });
        
        // Au redémarrage de la vidéo
        video.addEventListener('seeked', function() {
            if (video.currentTime === 0) {
                video.style.opacity = 0;
                setTimeout(() => {
                    video.style.opacity = 1;
                }, 10);
            }
        });
    });
</script>
{% endblock %}