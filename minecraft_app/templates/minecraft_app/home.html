{% extends 'minecraft_app/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="video-background">
        <video id="background-video" autoplay loop muted playsinline>
            <source src="{% static 'videos/background_loop.mp4' %}" type="video/mp4">
        </video>
        <div class="video-overlay"></div>
    </div>
    
    <div class="hero-content">
        <div class="hero-title-image">
            <img src="{% static 'images/TEXT_NOVANIA.png' %}" alt="Novania" class="text-logo">
        </div>
        <p class="hero-subtitle">Towny Minecraft Server on an Earth Map</p>
        <p class="hero-description">Create your town, join a nation, and shape the history of the world your way.</p>
        <div class="hero-buttons">
            <a href="#join" class="btn btn-accent glow-effect">Play Now</a>
            <a href="{% url 'dynmap' %}" class="btn glass-effect">View Map</a>
        </div>
    </div>
</section>

<!-- Server Join Section -->
<section id="join" class="join-section">
    <div class="container">
        <h2 class="section-title">Join the Adventure</h2>
        <p class="section-subtitle">Embark on an epic journey through our Earth-scale world</p>
        
        <div class="server-info-card">
            <div class="server-info-header">
                <div class="server-name">Novania - Earth Towny</div>
                <div class="server-status">
                    <span class="status-indicator {% if server.status %}status-online{% else %}status-offline{% endif %}"></span>
                    <span>{% if server.status %}Online{% else %}Offline{% endif %}</span>
                    <span class="player-count">{{ server.player_count }}/{{ server.max_players }}</span>
                </div>
            </div>
            
            <div class="server-content">
                <p class="server-description">Join a community of builders, traders, and adventurers on our immersive 1:1000 scale Earth map. Claim your territory, build your town, and shape the history of our virtual world.</p>
                
                <div id="server-ip" class="server-ip">play.novania.fr</div>
                
                <div class="join-now">
                    
                    <p>Simply copy the server address and add it to your Minecraft server list</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Script pour copier l'IP au clic -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const serverIp = document.getElementById('server-ip');
        const copyBtn = document.getElementById('copy-ip');
        
        // Fonction pour copier l'IP au clic
        function copyIpToClipboard() {
            const ip = 'play.novania.fr';
            navigator.clipboard.writeText(ip).then(function() {
                // Effet visuel pour indiquer la copie
                copyBtn.textContent = 'IP Copied!';
                copyBtn.classList.add('copied');
                
                setTimeout(function() {
                    copyBtn.textContent = 'Copy IP Address';
                    copyBtn.classList.remove('copied');
                }, 2000);
            });
        }
        
        // Ajouter l'événement au clic sur le bouton et sur l'IP
        copyBtn.addEventListener('click', copyIpToClipboard);
        serverIp.addEventListener('click', copyIpToClipboard);
    });
</script>

<!-- Features Section -->
<section class="features-section">
    <div class="container">
        <h2 class="section-title">Discover Our Features</h2>
        <p class="section-subtitle">What makes Novania unique</p>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-globe-europe"></i>
                </div>
                <h3 class="feature-title">Earth Map</h3>
                <p class="feature-description">Explore our realistic 1:1000 scale map of Earth. Found nations in real-world locations and claim territories with geographical advantages.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-landmark"></i>
                </div>
                <h3 class="feature-title">Towny System</h3>
                <p class="feature-description">Create your own town, join a nation, and build alliances. Engage in diplomacy, trade or territorial wars with other players.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="feature-title">Active Community</h3>
                <p class="feature-description">Join our welcoming community of builders, explorers and strategists working together to recreate history or forge new paths.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-coins"></i>
                </div>
                <h3 class="feature-title">Dynamic Economy</h3>
                <p class="feature-description">Participate in our player-driven economy with shops, trades, and jobs. Build wealth through strategy and collaboration.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="feature-title">Land Protection</h3>
                <p class="feature-description">Your claims are fully protected against griefing with our advanced protection system while still enabling strategic gameplay.</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-cogs"></i>
                </div>
                <h3 class="feature-title">Custom Plugins</h3>
                <p class="feature-description">Experience unique gameplay with our custom-developed plugins designed to enhance the Earth Towny experience and make gameplay more immersive.</p>
            </div>
        </div>
    </div>
</section>

<!-- Featured Nations Section -->
<section class="nations-section">
    <div class="container">
        <h2 class="section-title">Featured Nations</h2>
        <p class="section-subtitle">The most powerful civilizations shaping our world</p>
        
        <div class="nations-grid">
            {% for nation in nations|slice:":3" %}
                <div class="nation-card">
                    <div class="nation-banner">
                        <div class="nation-flag">
                            <img src="{{ nation.flag_image|default:'static/images/default-flag.jpg' }}" alt="{{ nation.name }} Flag">
                        </div>
                    </div>
                    
                    <div class="nation-content">
                        <h3 class="nation-name">{{ nation.name }}</h3>
                        <div class="nation-info">
                            <div class="nation-info-item">
                                <i class="fas fa-landmark"></i>
                                <span>Capital: {{ nation.capital }}</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-crown"></i>
                                <span>Leader: {{ nation.leader }}</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-city"></i>
                                <span>Towns: {{ nation.towns_count }}</span>
                            </div>
                        </div>
                        
                        {% if nation.description %}
                        <p class="nation-description">{{ nation.description|truncatechars:100 }}</p>
                        {% else %}
                        <p class="nation-description">A prosperous nation with rich history and culture, making its mark on the Novania world.</p>
                        {% endif %}
                        
                        <div class="nation-action">
                            <a href="{% url 'nation_detail' nation.id %}" class="nation-btn">
                                <span>View Nation</span>
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <!-- Exactly 3 sample nations if no data available -->
                <div class="nation-card">
                    <div class="nation-banner">
                        <div class="nation-flag">
                            <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                        </div>
                    </div>
                    
                    <div class="nation-content">
                        <h3 class="nation-name">Britannia</h3>
                        <div class="nation-info">
                            <div class="nation-info-item">
                                <i class="fas fa-landmark"></i>
                                <span>Capital: London</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-crown"></i>
                                <span>Leader: KingArthur</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-city"></i>
                                <span>Towns: 7</span>
                            </div>
                        </div>
                        
                        <p class="nation-description">A naval power with colonial ambitions, known for its parliamentary system and diplomatic relations.</p>
                        
                        <div class="nation-action">
                            <a href="#" class="nation-btn">
                                <span>View Nation</span>
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="nation-card">
                    <div class="nation-banner">
                        <div class="nation-flag">
                            <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                        </div>
                    </div>
                    
                    <div class="nation-content">
                        <h3 class="nation-name">Nova Roma</h3>
                        <div class="nation-info">
                            <div class="nation-info-item">
                                <i class="fas fa-landmark"></i>
                                <span>Capital: Roma</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-crown"></i>
                                <span>Leader: Caesar_Augustus</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-city"></i>
                                <span>Towns: 5</span>
                            </div>
                        </div>
                        
                        <p class="nation-description">An empire dedicated to preserving the glory of ancient Rome with grand architecture and military might.</p>
                        
                        <div class="nation-action">
                            <a href="#" class="nation-btn">
                                <span>View Nation</span>
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="nation-card">
                    <div class="nation-banner">
                        <div class="nation-flag">
                            <img src="{% static 'images/default-flag.jpg' %}" alt="Nation Flag">
                        </div>
                    </div>
                    
                    <div class="nation-content">
                        <h3 class="nation-name">Nippon</h3>
                        <div class="nation-info">
                            <div class="nation-info-item">
                                <i class="fas fa-landmark"></i>
                                <span>Capital: Tokyo</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-crown"></i>
                                <span>Leader: ShogunTakeda</span>
                            </div>
                            <div class="nation-info-item">
                                <i class="fas fa-city"></i>
                                <span>Towns: 4</span>
                            </div>
                        </div>
                        
                        <p class="nation-description">An island nation known for its beautiful traditional architecture and technological advancements.</p>
                        
                        <div class="nation-action">
                            <a href="#" class="nation-btn">
                                <span>View Nation</span>
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>



<section class="cta-section">
    <div class="cta-overlay"></div>
    <div class="cta-particles"></div>
    
    <div class="container">
        <div class="cta-container">
            <div class="cta-content">
                <h2 class="cta-title">Ready to Start Your Adventure?</h2>
                <p class="cta-text">Join our Discord community to connect with other players, get help, and stay updated on server events and announcements.</p>
                
                <div class="cta-actions">
                    <a href="https://discord.gg/a8G7wUKp2Y" class="btn cta-discord-btn" target="_blank">
                        <i class="fab fa-discord"></i>
                        <span>Join Our Discord</span>
                    </a>
                    <a href="{% url 'rules' %}" class="btn cta-rules-btn">
                        <i class="fas fa-scroll"></i>
                        <span>Read the Rules</span>
                    </a>
                </div>
                
                <div class="cta-server-info">
                    <div class="server-status-badge">
                        <span class="status-indicator {% if server.status %}status-online{% else %}status-offline{% endif %}"></span>
                        <span class="status-text">{% if server.status %}Server Online{% else %}Server Offline{% endif %}</span>
                    </div>
                    <div class="player-count-badge">
                        <i class="fas fa-users"></i>
                        <span>{{ server.player_count }}/{{ server.max_players }} Players</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const video = document.getElementById('background-video');
        
        // Créer l'effet de fondu à la fin de chaque lecture
        video.addEventListener('timeupdate', function() {
            // Si la vidéo est proche de la fin (2 secondes avant)
            if (video.currentTime >= video.duration - 2) {
                // Commencer le fondu
                video.style.opacity = 1 - ((video.duration - video.currentTime) / 2);
            } else if (video.currentTime <= 2) {
                // Fondu en entrée au début
                video.style.opacity = video.currentTime / 2;
            } else {
                // Opacité normale pendant la lecture
                video.style.opacity = 1;
            }
        });
        
        // Au redémarrage de la vidéo
        video.addEventListener('seeked', function() {
            if (video.currentTime === 0) {
                video.style.opacity = 0;
                setTimeout(() => {
                    video.style.opacity = 1;
                }, 10);
            }
        });
    });
</script>
{% endblock %}